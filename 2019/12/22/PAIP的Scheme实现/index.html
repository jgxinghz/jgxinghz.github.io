<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=0"><title>PAIP的Scheme实现 [ Hexo ] </title><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.bootcss.com/highlight.js/9.6.0/styles/github.min.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Abril+Fatface&amp;display=swap"><script src="https://cdn.bootcss.com/highlight.js/9.6.0/highlight.min.js"></script><script src="/js/paper.js"></script><meta name="generator" content="Hexo 4.1.1"></head><body><div class="mask-border"></div><div class="scrollbar"><div class="head"><div class="head__inner"><h1><a href="/">Hexo</a></h1><p></p></div></div><div class="paper-container"><div class="main"><div class="location-bar"><div class="line-1"><div class="horizontal-line" style="height: 3px"></div></div><div class="line-2"><div class="horizontal-line" style="height: 1px"></div></div><p class="text">PAIP的Scheme实现</p><div class="switch-button"><input class="container_toggle" type="checkbox" id="switch" name="mode"><label for="switch">Toggle</label></div><div class="line-3"><div class="horizontal-line" style="height: 1px"></div></div></div><div class="main__2-col"><article class="post-view__article"><div class="article__infomation"><div class="posts__item"><h2><a href="">PAIP的Scheme实现</a></h2><span class="post__date">2019-12-22</span><a href="/tags/PAIP-Scheme-Lisp/"><span class="post__tags">#PAIP Scheme Lisp</span></a></div></div><div class="article__content"><h1 id="CHAPTER-2"><a href="#CHAPTER-2" class="headerlink" title="CHAPTER 2"></a>CHAPTER 2</h1><h1 id="A-Simple-Lisp-Program"><a href="#A-Simple-Lisp-Program" class="headerlink" title="A Simple Lisp Program"></a>A Simple Lisp Program</h1><p>一个简单语法</p>
<figure class="highlight ini"><table><tr><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">Sentence</span> =&gt; Noun-Phrase + Verb-Phrase<br><span class="hljs-attr">Noun-Phrase</span> =&gt; Article + Noun<br><span class="hljs-attr">Verb-Phrase</span> =&gt; Verb + Noun-Phrase<br><span class="hljs-attr">Article</span> =&gt; the, a, . . .<br><span class="hljs-attr">Noun</span> =&gt; man, ball, woman, table. . .<br><span class="hljs-attr">Verb</span> =&gt; hit, took, saw, liked. . .<br></code></pre></td></tr></table></figure>

<p>一种直接实现</p>
<figure class="highlight scheme"><table><tr><td class="code"><pre><code class="hljs scheme">(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span>(<span class="hljs-name">sentence</span>) (<span class="hljs-name"><span class="hljs-builtin-name">append</span></span> (<span class="hljs-name">noun-phrase</span>) (<span class="hljs-name">verb-phrase</span>)))<br>(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">noun-phrase</span>) (<span class="hljs-name"><span class="hljs-builtin-name">append</span></span> (<span class="hljs-name">Article</span>) (<span class="hljs-name">Noun</span>)))<br>(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">verb-phrase</span>) (<span class="hljs-name"><span class="hljs-builtin-name">append</span></span> (<span class="hljs-name">Verb</span>) (<span class="hljs-name">noun-phrase</span>)))<br>(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">Article</span>) (<span class="hljs-name">one-of</span> '(the a)))<br>(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">Noun</span>) (<span class="hljs-name">one-of</span> '(man ball woman table)))<br>(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">Verb</span>) (<span class="hljs-name">one-of</span> '(hit took saw liked)))<br></code></pre></td></tr></table></figure>

<p>其中</p>
<figure class="highlight scheme"><table><tr><td class="code"><pre><code class="hljs scheme">(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">one-of</span> s)<br>  (<span class="hljs-name"><span class="hljs-builtin-name">list</span></span> (<span class="hljs-name">random-elt</span> s)))<br><br>(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">random-elt</span> choices)<br>  (<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">elt</span> i s)<br>    (<span class="hljs-name"><span class="hljs-builtin-name">if</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">=</span></span> i <span class="hljs-number">0</span>)<br>        (<span class="hljs-name"><span class="hljs-builtin-name">car</span></span> s)<br>        (<span class="hljs-name">elt</span> (<span class="hljs-name"><span class="hljs-builtin-name">-</span></span> i <span class="hljs-number">1</span>) (<span class="hljs-name"><span class="hljs-builtin-name">cdr</span></span> s))))  <br>  (<span class="hljs-name"><span class="hljs-builtin-name">let</span></span> ((<span class="hljs-name">index</span> (<span class="hljs-name">random</span> (<span class="hljs-name"><span class="hljs-builtin-name">length</span></span> choices))))<br>    (<span class="hljs-name">elt</span> index choices)))<br></code></pre></td></tr></table></figure>

<p>更复杂的语法</p>
<figure class="highlight livescript"><table><tr><td class="code"><pre><code class="hljs livescript">Noun-Phrase =&gt; Article + Adj* + Noun + PP*<br>Adj* =&gt; , Adj + Adj*<br>PP* =&gt; <span class="hljs-number">0</span>, PP + PP*<br>PP =&gt; Prep + Noun-Phrase<br>Adj =&gt; big, little, blue, green, . . .<br>Prep =&gt; <span class="hljs-keyword">to</span>, <span class="hljs-keyword">in</span>, <span class="hljs-keyword">by</span>, <span class="hljs-keyword">with</span>, . . .<br></code></pre></td></tr></table></figure>

<p>scheme实现：</p>
<figure class="highlight scheme"><table><tr><td class="code"><pre><code class="hljs scheme">(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">Adj*</span>)<br>  (<span class="hljs-name"><span class="hljs-builtin-name">if</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">=</span></span> (<span class="hljs-name">random</span> <span class="hljs-number">2</span>) <span class="hljs-number">0</span>)<br>      '()<br>      (<span class="hljs-name"><span class="hljs-builtin-name">append</span></span> (<span class="hljs-name">Adj</span>) (<span class="hljs-name">Adj*</span>))))<br><br>(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">PP*</span>)<br>  (<span class="hljs-name"><span class="hljs-builtin-name">if</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">=</span></span> (<span class="hljs-name">random</span> <span class="hljs-number">2</span>) <span class="hljs-number">0</span>)<br>      '()<br>      (<span class="hljs-name"><span class="hljs-builtin-name">append</span></span> (<span class="hljs-name">PP</span>) (<span class="hljs-name">PP*</span>))))<br><br>(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span>(<span class="hljs-name">sentence</span>) (<span class="hljs-name"><span class="hljs-builtin-name">append</span></span> (<span class="hljs-name">noun-phrase</span>) (<span class="hljs-name">verb-phrase</span>)))<br>(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">noun-phrase</span>) (<span class="hljs-name"><span class="hljs-builtin-name">append</span></span> (<span class="hljs-name">Article</span>) (<span class="hljs-name">Adj*</span>) (<span class="hljs-name">Noun</span>) (<span class="hljs-name">PP*</span>)))<br>(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">Adj</span>) (<span class="hljs-name">one-of</span> '(big little blue green adibatic)))<br>(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">PP</span>) (<span class="hljs-name"><span class="hljs-builtin-name">append</span></span> (<span class="hljs-name">Prep</span>) (<span class="hljs-name">noun-phrase</span>)))<br>(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">Prep</span>) (<span class="hljs-name">one-of</span> '(to in by with on)))<br>(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">verb-phrase</span>) (<span class="hljs-name"><span class="hljs-builtin-name">append</span></span> (<span class="hljs-name">Verb</span>) (<span class="hljs-name">noun-phrase</span>)))<br>(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">Article</span>) (<span class="hljs-name">one-of</span> '(the a)))<br>(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">Noun</span>) (<span class="hljs-name">one-of</span> '(man ball woman table)))<br>(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">Verb</span>) (<span class="hljs-name">one-of</span> '(hit took saw liked)))<br></code></pre></td></tr></table></figure>



<h2 id="2-3-A-Rule-based-solution"><a href="#2-3-A-Rule-based-solution" class="headerlink" title="2.3 A Rule-based solution"></a>2.3 A Rule-based solution</h2><p>语法定义</p>
<figure class="highlight scheme"><table><tr><td class="code"><pre><code class="hljs scheme">(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> simple-grammar<br>  '((sentence -&gt; (noun-phrase verb-phrase))<br>    (noun-phrase -&gt; (Article Noun))<br>    (verb-phrase -&gt; (Verb noun-phrase))<br>    (Article -&gt; the a)<br>    (Noun -&gt; man ball woman table)<br>    (Verb -&gt; hit took saw liked)))<br><br>(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> *grammar* simple-grammar)<br></code></pre></td></tr></table></figure>

<p>生成函数</p>
<figure class="highlight scheme"><table><tr><td class="code"><pre><code class="hljs scheme">(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">generate</span> phrase)<br>  (<span class="hljs-name"><span class="hljs-builtin-name">cond</span></span> ((<span class="hljs-name"><span class="hljs-builtin-name">list?</span></span> phrase) (<span class="hljs-name">mappend</span> generate phrase))<br>        ((<span class="hljs-name">rewrites</span> phrase)<br>         (<span class="hljs-name">generate</span> (<span class="hljs-name">random-elt</span> (<span class="hljs-name">rewrites</span> phrase))))<br>        (<span class="hljs-name"><span class="hljs-builtin-name">else</span></span><br>         (<span class="hljs-name"><span class="hljs-builtin-name">list</span></span> phrase))))<br><br>(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">rewrites</span> category)<br>  (<span class="hljs-name">rule-rhs</span> (<span class="hljs-name"><span class="hljs-builtin-name">assoc</span></span> category *grammar*)))<br><br>(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">rule-rhs</span> rule)<br>  (<span class="hljs-name"><span class="hljs-builtin-name">cond</span></span> ((<span class="hljs-name"><span class="hljs-builtin-name">not</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">pair?</span></span> rule)) false)<br>        ((<span class="hljs-name"><span class="hljs-builtin-name">cdr</span></span> rule) (<span class="hljs-name">cddr</span> rule))<br>        (<span class="hljs-name"><span class="hljs-builtin-name">else</span></span> false)))<br><br>(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">rule-lhs</span> rule)<br>  (<span class="hljs-name"><span class="hljs-builtin-name">car</span></span> rule))<br></code></pre></td></tr></table></figure>

<p>其中mappend为：</p>
<figure class="highlight scheme"><table><tr><td class="code"><pre><code class="hljs scheme">(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">mappend</span> f ls)<br>  <span class="hljs-comment">;将ls中每个元素应用f后结果append</span><br>  (<span class="hljs-name"><span class="hljs-builtin-name">if</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">null?</span></span> ls)<br>      '()<br>      (<span class="hljs-name"><span class="hljs-builtin-name">append</span></span> (<span class="hljs-name">f</span> (<span class="hljs-name"><span class="hljs-builtin-name">car</span></span> ls)) (<span class="hljs-name">mappend</span> f (<span class="hljs-name"><span class="hljs-builtin-name">cdr</span></span> ls)))))<br></code></pre></td></tr></table></figure>

<p>generate的另一种实现为：</p>
<figure class="highlight scheme"><table><tr><td class="code"><pre><code class="hljs scheme">(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">generate</span> phrase)<br>  (<span class="hljs-name"><span class="hljs-builtin-name">if</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">list?</span></span> phrase)<br>      (<span class="hljs-name">mappend</span> generate phrase)<br>      (<span class="hljs-name"><span class="hljs-builtin-name">let</span></span> ((<span class="hljs-name">choices</span> (<span class="hljs-name">rewrites</span> phrase)))<br>        (<span class="hljs-name"><span class="hljs-builtin-name">if</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">list?</span></span> choices)            <br>            (<span class="hljs-name">generate</span> (<span class="hljs-name">random-elt</span> choices))<br>            (<span class="hljs-name"><span class="hljs-builtin-name">list</span></span> phrase)))))<br></code></pre></td></tr></table></figure>



<h2 id="2-5-Changing-the-Grammar-without-Changing-the-Program"><a href="#2-5-Changing-the-Grammar-without-Changing-the-Program" class="headerlink" title="2.5 Changing the Grammar without Changing the Program"></a>2.5 Changing the Grammar without Changing the Program</h2><p>定义一个新的文法：</p>
<figure class="highlight scheme"><table><tr><td class="code"><pre><code class="hljs scheme">(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> bigger-grammar<br>  '((sentence -&gt; (noun-phrase verb-phrase))<br>    (noun-phrase -&gt; (Article Adj* Noun PP*))<br>    (verb-phrase -&gt; (Verb noun-phrase PP*))<br>    (PP* -&gt; () (PP PP*))<br>    (Adj* -&gt; () (Adj Adj*))<br>    (PP -&gt; (Prep noun-phrase))<br>    (Prep -&gt; to in by with on)<br>    (Adj -&gt; big little blue green adiabatic)<br>    (Article -&gt; the a)<br>    (Name -&gt; Pat Kim Lee Terry Robin)<br>    (Noun -&gt; man ball woamn table)<br>    (Verb -&gt; hit took saw liked)<br>    (Pronoun -&gt; he she it these those that)))<br><br>(<span class="hljs-name"><span class="hljs-builtin-name">set!</span></span> *grammar* bigger-grammar)<br></code></pre></td></tr></table></figure>

<p>可以生成的句子：</p>
<figure class="highlight scheme"><table><tr><td class="code"><pre><code class="hljs scheme">'(the adiabatic woamn saw the ball with a blue big table)<br></code></pre></td></tr></table></figure>

<h2 id="2-6-Using-the-Same-Data-for-Several-Programs"><a href="#2-6-Using-the-Same-Data-for-Several-Programs" class="headerlink" title="2.6 Using the Same Data for Several Programs"></a>2.6 Using the Same Data for Several Programs</h2><p>生成语法树：</p>
<figure class="highlight scheme"><table><tr><td class="code"><pre><code class="hljs scheme">(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">generate-tree</span> phrase)<br>  (<span class="hljs-name"><span class="hljs-builtin-name">cond</span></span> ((<span class="hljs-name"><span class="hljs-builtin-name">list?</span></span> phrase)<br>         (<span class="hljs-name"><span class="hljs-builtin-name">map</span></span> generate-tree phrase))<br>        ((<span class="hljs-name">rewrites</span> phrase)<br>         (<span class="hljs-name"><span class="hljs-builtin-name">cons</span></span> phrase<br>               (<span class="hljs-name">generate-tree</span> (<span class="hljs-name">random-elt</span> (<span class="hljs-name">rewrites</span> phrase)))))<br>        (<span class="hljs-name"><span class="hljs-builtin-name">else</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">list</span></span> phrase))))<br></code></pre></td></tr></table></figure>

<p>生成所有的可能输出：</p>
<figure class="highlight scheme"><table><tr><td class="code"><pre><code class="hljs scheme">(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">generate-all</span> phrase)<br>  (<span class="hljs-name"><span class="hljs-builtin-name">cond</span></span> ((<span class="hljs-name"><span class="hljs-builtin-name">null?</span></span> phrase) (<span class="hljs-name"><span class="hljs-builtin-name">list</span></span> '()))<br>        ((<span class="hljs-name"><span class="hljs-builtin-name">list?</span></span> phrase)<br>         (<span class="hljs-name">combine-all</span> (<span class="hljs-name">generate-all</span> (<span class="hljs-name"><span class="hljs-builtin-name">car</span></span> phrase))<br>                      (<span class="hljs-name">generate-all</span> (<span class="hljs-name"><span class="hljs-builtin-name">cdr</span></span> phrase))))<br>        ((<span class="hljs-name">rewrites</span> phrase)<br>         (<span class="hljs-name">mappend</span> generate-all (<span class="hljs-name">rewrites</span> phrase)))<br>        (<span class="hljs-name"><span class="hljs-builtin-name">else</span></span><br>         (<span class="hljs-name"><span class="hljs-builtin-name">list</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">list</span></span> phrase)))))<br></code></pre></td></tr></table></figure>

<p>其中combine-all为：</p>
<figure class="highlight scheme"><table><tr><td class="code"><pre><code class="hljs scheme">(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">combine-all</span> xlist ylist)<br>  (<span class="hljs-name">mappend</span> (<span class="hljs-name"><span class="hljs-builtin-name">lambda</span></span>(y)<br>             (<span class="hljs-name"><span class="hljs-builtin-name">map</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">lambda</span></span>(x) (<span class="hljs-name"><span class="hljs-builtin-name">append</span></span> x y)) xlist))<br>           ylist))<br></code></pre></td></tr></table></figure>



<h3 id="2-7-练习"><a href="#2-7-练习" class="headerlink" title="2.7 练习"></a>2.7 练习</h3><p>2.3、定义语法：</p>
<figure class="highlight scheme"><table><tr><td class="code"><pre><code class="hljs scheme">(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> 中文语法<br>  '((句子 -&gt; (名词短语 谓语))<br>    (名词短语 -&gt; (形容词* 名词))<br>    (形容词* -&gt; () (形容词 形容词*))<br>    (谓语 -&gt; (动词 名词短语))<br>    (形容词 -&gt; 大 小 蓝色的 绿色的)<br>    (名词 -&gt; 男人 球 女人 桌子)<br>    (动词 -&gt; 拿 看见 喜欢 打)))<br></code></pre></td></tr></table></figure>



<p>2.4、cross-product</p>
<figure class="highlight scheme"><table><tr><td class="code"><pre><code class="hljs scheme">(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">cross-product</span> f xlist ylist)<br>  (<span class="hljs-name">mappend</span> (<span class="hljs-name"><span class="hljs-builtin-name">lambda</span></span>(y)<br>             (<span class="hljs-name"><span class="hljs-builtin-name">map</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">lambda</span></span>(x) (<span class="hljs-name">f</span> x y)) xlist))<br>           ylist))<br><br>(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">combine-all-1</span> xlist ylist)<br>  (<span class="hljs-name">cross-product</span> append xlist ylist))<br></code></pre></td></tr></table></figure>



</div></article><div class="post-view__sidebar"><div class="sidebar"><h2>Links</h2><div class="sidebar__link"><ul><li><a href="https://github.com/yours" target="_blank" rel="noopener">Github</a></li><li><a href="https://codepen.io/yours" target="_blank" rel="noopener">Codepen</a></li><li><a href="https://dribbble.com/yours" target="_blank" rel="noopener">Dribbble</a></li><li><a href="https://twitter.com/yours" target="_blank" rel="noopener">twitter</a></li><li><a href="https://www.zhihu.com/people/yours" target="_blank" rel="noopener">知乎</a></li><li><a href="https://juejin.im/user/yours" target="_blank" rel="noopener">掘金</a></li></ul></div><h2>Archives</h2><div class="sidebar__archives"><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/">2019</a></li></ul></div><h2>Tags</h2><div class="sidebar__tags"><ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/PAIP-Scheme-Lisp/" rel="tag">PAIP Scheme Lisp</a></li></ul></div></div></div></div><div class="horizontal-line" style="height: 1px"></div><div class="main__bottom"><div class="pre-next"><a class="pre-button">没有更多</a><a class="next-button" href="/2019/12/22/test-my-site/">test_my_site</a></div></div></div></div><div class="footer"><span>©️2019-2020 Designed By <strong><a href="https://github.com/OfficialYoungX" target="_blank" rel="noopener">RandomYang</a></strong> Powered By </span><a href="https://hexo.io" target="_blank" rel="noopener">hexo</a></div></div><div class="darkmode-mask" id="darkmode-mask"></div><div class="sidebar__button"></div></body></html>